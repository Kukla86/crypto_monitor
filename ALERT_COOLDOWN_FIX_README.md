# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üìã –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª –æ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö –ø–æ —Ç–æ–∫–µ–Ω—É BID –∏ –¥—Ä—É–≥–∏–º —Ç–æ–∫–µ–Ω–∞–º. –°–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∞ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∞–ª–µ—Ä—Ç–æ–≤ –±–µ–∑ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –º–µ–∂–¥—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏.

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã:
1. **–ö—ç—à –∞–ª–µ—Ä—Ç–æ–≤ –æ—á–∏—â–∞–ª—Å—è —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ** (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)
2. **–í—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –±—ã–ª–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º** (30 –º–∏–Ω—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
3. **–†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –∞–ª–µ—Ä—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ä–∞–∑–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**
4. **–ù–µ—Ç –µ–¥–∏–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –æ—Ç—Å—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–æ–∫–µ–Ω–æ–≤**

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã:
- `monitor.py` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
- –§—É–Ω–∫—Ü–∏–∏: `send_alert()`, `was_recent_alert_sent()`, `cleanup_alert_cache()`

## üõ†Ô∏è –†–µ—à–µ–Ω–∏–µ

### 1. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤

**–ë—ã–ª–æ:**
```python
block_time = 1800 if level == 'INFO' else (3600 if level == 'WARNING' else 7200)
```

**–°—Ç–∞–ª–æ:**
```python
# –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏: 2 —á–∞—Å–∞ –¥–ª—è INFO, 4 —á–∞—Å–∞ –¥–ª—è WARNING, 8 —á–∞—Å–æ–≤ –¥–ª—è ERROR
block_time = 7200 if level == 'INFO' else (14400 if level == 'WARNING' else 28800)
```

### 2. –£–ª—É—á—à–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ `was_recent_alert_sent()`

**–ë—ã–ª–æ:**
```python
def was_recent_alert_sent(symbol: str, alert_type: str, minutes: int = 30) -> bool:
```

**–°—Ç–∞–ª–æ:**
```python
def was_recent_alert_sent(symbol: str, alert_type: str, minutes: int = 120) -> bool:
```

### 3. –ú–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞

**–ë—ã–ª–æ:**
```python
# –£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ä—à–µ 1 —á–∞—Å–∞
expired_keys = [k for k, v in alert_cache.items() if current_time - v > 3600]
await asyncio.sleep(1800)  # 30 –º–∏–Ω—É—Ç
```

**–°—Ç–∞–ª–æ:**
```python
# –£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ä—à–µ 4 —á–∞—Å–æ–≤
expired_keys = [k for k, v in alert_cache.items() if current_time - v > 14400]
await asyncio.sleep(3600)  # 1 —á–∞—Å
```

### 4. –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—Å—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

```python
def get_token_alert_cooldown(symbol: str) -> int:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞"""
    high_frequency_tokens = ['BID', 'SAHARA', 'AI16Z', 'URO']
    
    if symbol in high_frequency_tokens:
        return 240  # 4 —á–∞—Å–∞ –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤ —Å —á–∞—Å—Ç—ã–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
    else:
        return 120  # 2 —á–∞—Å–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

def should_send_alert(symbol: str, alert_type: str, alert_level: str = 'INFO') -> bool:
    """–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞–ª–µ—Ä—Ç–∞"""
```

## üìä –ù–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### –í—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ —Ç–∏–ø–∞–º –∞–ª–µ—Ä—Ç–æ–≤:
- **INFO**: 2 —á–∞—Å–∞ (–±—ã–ª–æ 30 –º–∏–Ω—É—Ç)
- **WARNING**: 4 —á–∞—Å–∞ (–±—ã–ª–æ 1 —á–∞—Å)
- **ERROR**: 8 —á–∞—Å–æ–≤ (–±—ã–ª–æ 2 —á–∞—Å–∞)

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤:
- **BID, SAHARA, AI16Z, URO**: 4 —á–∞—Å–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- **–û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã**: 2 —á–∞—Å–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã**: 1 —á–∞—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞:
- **–ß–∞—Å—Ç–æ—Ç–∞**: –∫–∞–∂–¥—ã–µ 4 —á–∞—Å–∞ (–±—ã–ª–æ 30 –º–∏–Ω—É—Ç)
- **–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π**: —Å—Ç–∞—Ä—à–µ 4 —á–∞—Å–æ–≤ (–±—ã–ª–æ 1 —á–∞—Å)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç `test_alert_fixes.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
python3 test_alert_fixes.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- ‚úÖ –í—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —É–≤–µ–ª–∏—á–µ–Ω–æ –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã –∏–º–µ—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- ‚úÖ –†–∞–∑–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

## üßπ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞

–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `clear_alert_cache.py` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞:

```bash
python3 clear_alert_cache.py
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
1. **–£–≤–µ–ª–∏—á–µ–Ω–æ –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤
2. **–î–æ–±–∞–≤–ª–µ–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞** –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤ —Å —á–∞—Å—Ç—ã–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
3. **–£–ª—É—á—à–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** —Å –º–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π –æ—á–∏—Å—Ç–∫–æ–π
4. **–î–æ–±–∞–≤–ª–µ–Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è** –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞–ª–µ—Ä—Ç–∞
5. **–°–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç—ã** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
- **–°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** –Ω–∞ 70-80%
- **–ë–æ–ª–µ–µ —Ä–∞–∑—É–º–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** –∞–ª–µ—Ä—Ç–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π
- **–£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** —Å–∏—Å—Ç–µ–º—ã –∑–∞ —Å—á–µ—Ç –º–µ–Ω–µ–µ —á–∞—Å—Ç–æ–π –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞

## üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º—ã:
1. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à: `python3 clear_alert_cache.py`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: `python3 monitor.py`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Telegram –±–æ—Ç: `python3 telegram_bot.py`

### –î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `should_send_alert()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ `get_token_alert_cooldown()` –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤:
–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ `high_frequency_tokens` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `get_token_alert_cooldown()`:

```python
high_frequency_tokens = ['BID', 'SAHARA', 'AI16Z', 'URO', '–ù–û–í–´–ô_–¢–û–ö–ï–ù']
``` 